import{r as c,j as e,U as n}from"./app-MQ-yEurC.js";import{S as i}from"./sweetalert2.esm.all-DPJM2oV6.js";import{R as u}from"./ReactTable-CiiRreiS.js";import{D as m}from"./DashboardLayout-Q83-rxtQ.js";import"./index-FTPeQx5Q.js";import"./Dropdown-DtFVle0_.js";import"./transition-CQN9Mefa.js";import"./index-DzSybp8L.js";class w extends c.Component{constructor(l){super(l),this.state={data:[],columns:[{id:"no",accessor:"no",Header:"No.",width:50,className:"center"},{id:"picture",Header:"Picture",accessor:"photo",Cell:({row:a})=>e.jsx("img",{className:"",height:100,width:100,onError:t=>{t.target.src=a.original.sex=="Male"?"/adminlte/dist/assets/img/avatar.png":"/adminlte/dist/assets/img/avatar-f.jpeg"},alt:"Picture Error",src:a.original.photo!=null&&a.original.photo!=""?a.original.photo:a.original.sex=="Male"?"/adminlte/dist/assets/img/avatar.png":"/adminlte/dist/assets/img/avatar-f.jpeg"})},{id:"fullname",Header:"Fullname",width:800,accessor:"fullname"},{id:"student",Header:"No. of Students",width:150,className:"center",accessor:"total_student",Cell:({row:a})=>e.jsx(e.Fragment,{children:e.jsx("button",{className:"btn btn-info btn-sm",onClick:()=>{$("#student_list").modal("show")},children:a.original.total_student})})},{id:"Status",Header:"Status",width:150,accessor:"status",className:"center"},{id:"action",Header:"Action",width:200,accessor:"status",className:"center",Cell:({row:a})=>e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-danger btn-block btn-sm col-12 mb-1",onClick:()=>{this.deleteParent(a.original.id)},children:[" ",e.jsx("i",{className:"bi bi-person-fill-x"})," Remove"]}),e.jsxs(n,{href:`/admin/dashboard/parents/update/${a.original.id}`,className:"btn btn-primary btn-block btn-sm col-12 mb-1",children:[" ",e.jsx("i",{className:"bi bi-pen"})," Edit"]})]})}]},this._isMounted=!1,this.loadStudentList=this.loadStudentList.bind(this),this.deleteParent=this.deleteParent.bind(this)}componentDidMount(){this._isMounted=!0,this.loadStudentList(),this.loadStudentList()}loadStudentList(){let l=[],a=this;axios.get("/parents").then(function(t){console.log(t),typeof t.status<"u"&&t.status=="200"&&(typeof t.data<"u"&&typeof t.data.data<"u"?t.data.data:[]).forEach((s,d,r)=>{l.push({id:s.id,no:d+1,photo:s.picture_base64,lrn:s.lrn,fullname:`${s.last_name}, ${s.first_name} ${s.extension_name!=null?s.extension_name:""} ${s.middle_name}`.toLocaleUpperCase(),level:"None",section:"None",sex:s.sex,status:s.status,total_student:s.total_student}),d+1==r.length&&a.setState({data:l})})}).catch(function(t){}).finally(function(){})}deleteParent(l){i.fire({title:"Are you sure to remove this data?",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Yes",confirmButtonColor:"red",icon:"question",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(a=>{a.isConfirmed?(i.fire({title:`Removing Records.
Please wait.`,showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,didOpen:()=>{i.showLoading()}}),axios.delete("/parents",{data:{id:l}}).then(function(t){typeof t.status<"u"&&t.status=="201"?(typeof t.data<"u"&&typeof t.data<"u"?t.data:{}).status=="success"?i.fire({title:"Successfuly remove!",showCancelButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Ok",icon:"success",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(function(s){s.isConfirmed&&i.close()}):i.fire({title:"Fail to remove",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0}):typeof t.status<"u"&&t.status=="200"&&(typeof t.data<"u"&&typeof t.data<"u"?t.data:{}).status=="data_not_exist"&&i.fire({title:"Data Not Exist",cancelButtonText:"Ok",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})}).catch(function(t){console.log(t),i.fire({title:"Server Error",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})})):i.close()})}render(){return e.jsxs(m,{title:"Parents",user:this.props.auth.user,children:[e.jsx("div",{className:"app-content-header",children:e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-6",children:e.jsxs("h3",{className:"mb-0",children:[e.jsx("i",{className:"nav-icon bi bi-person-lines-fill"})," Parents / Guardian"]})}),e.jsx("div",{className:"col-sm-6",children:e.jsxs("ol",{className:"breadcrumb float-sm-end",children:[e.jsxs("li",{className:"breadcrumb-item",children:[e.jsx("i",{className:"bi bi-speedometer mr-2"}),e.jsx(n,{href:"/admin/dashboard",children:"Dashboard"})]}),e.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:"Parents"})]})})]})})}),e.jsx("div",{className:"app-content",children:e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"card mb-4",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title",children:[" ",e.jsx("i",{className:"bi bi-person"})," Parent List"]}),e.jsxs(n,{className:"btn btn-primary float-right mr-1",href:"/admin/dashboard/parents/new",children:[" ",e.jsx("i",{className:"bi bi-person-plus-fill"})," Add"]})]}),e.jsx("div",{className:"card-body",children:e.jsx(u,{className:"table table-bordered table-striped ",data:this.state.data,columns:this.state.columns},"react-tables")})]})})})})}),e.jsx("div",{className:"modal fade",tabIndex:"-1",role:"dialog",id:"student_list","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title fs-5",children:"Student List"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body"}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})})]})}}export{w as default};
