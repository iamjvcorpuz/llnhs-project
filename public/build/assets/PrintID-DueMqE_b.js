import{r as m,j as c}from"./app-MQ-yEurC.js";import{S as d}from"./sweetalert2.esm.all-DPJM2oV6.js";import"./index-FTPeQx5Q.js";import"./Dropdown-DtFVle0_.js";import"./index-DzSybp8L.js";import{E as h}from"./jspdf.plugin.autotable-CWwcz3KB.js";import{Q as p}from"./browser-Bt5TlLty.js";import"./transition-CQN9Mefa.js";import"./typeof-QjJsDpFa.js";class _ extends m.Component{constructor(a){super(a),this.state={code:"",lrn:"",picture:"",fullname1:"",lastname:"",track_strand:"",grade:"",section:"",sy:"",guardianname:"",relationship:"",guardiancontact:"",address:"",list:[]},$("body").attr("class",""),this.singleId=this.singleId.bind(this)}componentDidMount(){$("#frame1").height(0),d.fire({title:"Generating ID. Please wait.",showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Download",cancelButtonText:"Close",icon:"info",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0,didOpen:()=>{d.showLoading()}});try{let a=this.props.data.track.find(i=>i.name==this.props.data.student.flsh_track),e=this.props.data.strand.find(i=>i.name==this.props.data.student.flsh_strand),t=typeof a<"u"?a.acronyms:"",o=typeof e<"u"?e.acronyms:"",n=this.props.data.getSchoolStats!=null&&this.props.data.getSchoolStats.length>0?this.props.data.getSchoolStats[0].track:"",s=this.props.data.getSchoolStats!=null&&this.props.data.getSchoolStats.length>0?this.props.data.getSchoolStats[0].strand:"",r=this.props.data.track.length>0?this.props.data.track.find(i=>`${i.name} (${i.acronyms})`===n):"",l=this.props.data.strand.length>0?this.props.data.strand.find(i=>`${i.name} (${i.acronyms})`===s):"";this.setState({code:this.props.data.student.qr_code,lrn:this.props.data.student.lrn,picture:this.props.data.student.picture_base64,fullname1:this.props.data.student.first_name+" "+this.props.data.student.middle_name,lastname:this.props.data.student.last_name,track_strand:t!=""||t!=""?t+"-"+o:"",guardianname:this.props.data.guardian[0].first_name+" "+this.props.data.guardian[0].middle_name+" "+this.props.data.guardian[0].last_name,relationship:this.props.data.guardian[0].relationship,guardiancontact:this.props.data.guardian[0].phone_number,address:this.props.data.guardian[0].current_address,grade:this.props.data.getSchoolStats!=null&&this.props.data.getSchoolStats.length>0?this.props.data.getSchoolStats[0].grade:"",level:this.props.data.getSchoolStats!=null&&this.props.data.getSchoolStats.length>0?this.props.data.getSchoolStats[0].grade_level:"",section:this.props.data.getSchoolStats!=null&&this.props.data.getSchoolStats.length>0?this.props.data.getSchoolStats[0].section:"",_track:typeof r<"u"&&r!=null?r.acronyms:"",_strand:typeof l<"u"&&l!=null?l.acronyms:"",sy:this.props.data.getSchoolStats!=null&&this.props.data.getSchoolStats.length>0?this.props.data.getSchoolStats[0].sy:""},()=>{this.singleId()})}catch(a){console.log(a),d.fire({title:"Cannot continue because info is not completed",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Download",cancelButtonText:"Close",icon:"error",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0}).then(e=>{window.close()})}}async singleId(){try{let a=this,e="";const t=new h({}),o=210.1;t.addImage("/images/id/front.png","PNG",5,10,54,88),t.addImage("/images/id/back.png","PNG",60,10,54,88),this.state.picture!=""&&t.addImage(this.state.picture,"PNG",7.5,26.5,26,25),await(async r=>{try{e=await p.toDataURL(r,{errorCorrectionLevel:"H",margin:1}),t.addImage(e,7.7,57,18,18)}catch(l){console.error(l)}})(this.state.lrn),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.setFontSize(11),t.text(this.state.lrn.toLocaleUpperCase(),17,55,{align:"left",color:"white"}),t.setFont("helvetica","normal"),t.setFontSize(11),this.state.fullname1.length>=11&&t.setFontSize(8),t.text(this.state.fullname1.toLocaleUpperCase(),28,60,{align:"left",maxWidth:50}),t.setFont("helvetica","bold"),t.setFontSize(15);let s=66;this.state.fullname1.length>=18&&(s=70),this.state.lastname.length>10&&(t.setFontSize(10),s=64),this.state.lastname.length>13&&t.setFontSize(7),t.text(this.state.lastname.toLocaleUpperCase(),28,s,{align:"left",maxWidth:50}),t.setFont("helvetica","normal"),t.setFontSize(9),t.text(this.state.track_strand.toLocaleUpperCase(),28,73,{align:"left",maxWidth:50}),t.setFont("helvetica","bold"),t.setFontSize(7),t.text(this.state.grade.toLocaleUpperCase()+"-"+this.state.section.toLocaleUpperCase(),76,30,{align:"center",maxWidth:45}),t.text(this.state.sy.toLocaleUpperCase(),94,30,{align:"left",maxWidth:50}),t.setFont("helvetica","normal"),t.setFontSize(8),t.text(this.state.guardianname.toLocaleUpperCase(),63,43.5,{align:"left",maxWidth:80}),t.text(this.state.relationship.toLocaleUpperCase(),63,46,{align:"left",maxWidth:50}),t.text(this.state.guardiancontact.toLocaleUpperCase(),63,49,{align:"left",maxWidth:70}),t.text(this.state.address.toLocaleUpperCase(),63,52,{align:"left",maxWidth:79}),$("#frame1").height(window.innerHeight-8),console.log(t.output().length>=1e6,t.output().length),setTimeout(()=>{d.close(),$("#frame1").attr("src",t.output("bloburl"))},1e3)}catch(a){console.log(a),d.fire({title:"Cannot continue because info is not completed",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Download",cancelButtonText:"Close",icon:"error",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0}).then(e=>{window.close()})}}browser_check_preview(){let a=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,e=typeof InstallTrigger<"u",t=/constructor/i.test(window.HTMLElement)||function(l){return l.toString()==="[object SafariRemoteNotification]"}(!window.safari||typeof safari<"u"&&safari.pushNotification),o=!!document.documentMode,n=!o&&!!window.StyleMedia,s=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime),r=(s||a)&&!!window.CSS;return a?0:e||t?1:0}async multipleId(){let a="";const e=new h({});e.addImage("/images/id/front.png","PNG",5,5,81,130),e.addImage("/images/id/back.png","PNG",87,5,81,130),e.addImage(this.state.picture,"PNG",9,30,38,36);const t=async n=>{try{a=await p.toDataURL(n,{errorCorrectionLevel:"H"}),console.log(a),e.addImage(a,8,74,30,27)}catch(s){console.error(s)}};this.state.list.forEach(n=>{}),await t(this.state.lrn),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text(this.state.lrn.toLocaleUpperCase(),22,72,{align:"left",color:"white"}),e.setFont("helvetica","normal"),e.setFontSize(12),e.text(this.state.fullname1.toLocaleUpperCase(),39,78,{align:"left",maxWidth:50}),e.setFont("helvetica","bold"),e.setFontSize(15);let o=83;this.state.fullname1.length>=18&&(o=89),this.state.lastname.length<14&&(e.setFontSize(20),o=85),e.text(this.state.lastname.toLocaleUpperCase(),39,o,{align:"left",maxWidth:50}),e.setFont("helvetica","normal"),e.setFontSize(15),e.text(this.state.track_strand.toLocaleUpperCase(),39,96,{align:"left",maxWidth:50}),e.setFont("helvetica","bold"),e.setFontSize(12),e.text(this.state.grade.toLocaleUpperCase()+"-"+this.state.section.toLocaleUpperCase(),109,34,{align:"center",maxWidth:45}),e.text(this.state.sy.toLocaleUpperCase(),139,34,{align:"left",maxWidth:50}),e.setFont("helvetica","normal"),e.setFontSize(10),e.text(this.state.guardianname.toLocaleUpperCase(),90,56,{align:"left",maxWidth:80}),e.text(this.state.relationship.toLocaleUpperCase(),90,60,{align:"left",maxWidth:50}),e.text(this.state.guardiancontact.toLocaleUpperCase(),90,64,{align:"left",maxWidth:70}),e.text(this.state.address.toLocaleUpperCase(),90,68,{align:"left",maxWidth:79}),$("#frame1").attr("src",e.output("bloburl"))}render(){return c.jsx("div",{className:"",children:c.jsx("iframe",{id:"frame1",src:"#view=FitH&toolbar=0",width:"100%",height:"100%"})})}}export{_ as default};
