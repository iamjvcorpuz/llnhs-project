import{r as y,j as e,U as m,a as v}from"./app-MQ-yEurC.js";import{E as d}from"./EachMethod-DlQbtg5B.js";import{S as s}from"./sweetalert2.esm.all-DPJM2oV6.js";import{h as C}from"./moment-C5S46NFB.js";import"./index-B9Tcu3qw.js";import"./react-webcam-C_JsNYoc.js";import"./apexcharts.esm-CWma0ncG.js";import{R as p}from"./ReactTable-CiiRreiS.js";import{D as g}from"./DashboardLayout-Q83-rxtQ.js";import"./index-FTPeQx5Q.js";import"./Dropdown-DtFVle0_.js";import"./transition-CQN9Mefa.js";import"./index-DzSybp8L.js";class q extends y.Component{constructor(t){super(t),this.state={data:this.props.advisory,subjects:this.props.subjects,teachers:this.props.teacher,advisoryList:this.props.advisory,sectionListTemp:this.props.sections,sectionList:[],yeargrade:this.props.schoolyeargrades,selected_grade:"",selected_grade_id:"",selected_section:"",selected_section_id:"",selected_teacher_name:"",selected_teacher_id:"",selected_subject:"",selected_subejct_id:"",selected_school_year:"",columns:[{id:"no",accessor:"id",Header:"No.",width:70,className:"center"},{id:"section",Header:"Section",accessor:"section_name",width:300},{id:"year_level",Header:"Grade Level",width:200,accessor:"year_level"},{id:"school_year",Header:"S.Y.",width:200,accessor:"school_year"},{id:"total_students",Header:"No. Students",width:100,className:"center",accessor:"total_students"},{id:"Action",Header:"Action",width:150,accessor:"status",className:"center",Cell:({row:a})=>e.jsxs(e.Fragment,{children:[e.jsxs(m,{href:`/teacher/advisory/students/${a.original.qrcode}?stamp=${C(new Date).toString()}`,className:"btn btn-info btn-block btn-sm col-12",children:[" ",e.jsx("i",{className:"bi bi-eye"})," View"]}),e.jsxs(m,{href:`/teacher/advisory/final/grading/${a.original.qrcode}`,className:"btn btn-success btn-block btn-sm col-12 mt-1",children:[" ",e.jsx("i",{className:"bi bi-card-checklist"})," Final Grades "]})]})}]},this._isMounted=!1,this.saveData=this.saveData.bind(this),this.deleteAdvisory=this.deleteAdvisory.bind(this),this.getAllData=this.getAllData.bind(this),console.log(this.props)}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}getAllData(){let t=this;v.get("/advisory").then(function(a){if(console.log(a),typeof a.status<"u"&&a.status=="200"){let o=typeof a.data<"u"&&typeof a.data<"u"?a.data:{};Object.keys(o).length>0&&t.setState({data:o.advisory,subjects:o.subjects,teachers:o.teacher,advisoryList:o.advisory,sectionListTemp:o.sections,sectionList:[],yeargrade:o.schoolyeargrades})}})}deleteAdvisory(t){let a=this;s.fire({title:"Are you sure to remove this data?",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Yes",confirmButtonColor:"red",icon:"question",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(o=>{o.isConfirmed?(s.fire({title:`Removing Records.
Please wait.`,showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,didOpen:()=>{s.showLoading()}}),v.delete("/advisory",{data:{id:t}}).then(function(l){typeof l.status<"u"&&l.status=="201"?(typeof l.data<"u"&&typeof l.data<"u"?l.data:{}).status=="success"?(a.getAllData(),s.fire({title:"Successfuly remove!",showCancelButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Ok",icon:"success",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(function(c){c.isConfirmed&&s.close()})):s.fire({title:"Fail to remove",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0}):typeof l.status<"u"&&l.status=="200"&&(typeof l.data<"u"&&typeof l.data<"u"?l.data:{}).status=="data_not_exist"&&s.fire({title:"Data Not Exist",cancelButtonText:"Ok",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})}).catch(function(l){console.log(l),s.fire({title:"Server Error",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})})):s.close()})}saveData(){let t=this;console.log($("#teacher").val()),console.log($("#yearlevel").val()),console.log($("#yearlevel").val()),console.log($("#section").val()),console.log($("#subject").val());let a=$("#teacher").val(),o=t.state.teachers.find(r=>r.last_name+", "+r.first_name==a).id,l=$("#yearlevel").val(),n=t.state.sectionList.find(r=>r.id==$("#yearlevel").val()).year_grade,c=$("#section").val(),u=t.state.sectionList.find(r=>r.section_name==c).id,h=$("#schoolyear").val(),f=$("#subject").val();if(o!=""&&l!=""&&u!=""&&h!=""&&f!=""){if($("#invalidCheck").prop("checked")==!1){$("#invalidCheck-alert").removeAttr("class"),$("#invalidCheck-alert").addClass("d-block invalid-feedback"),alert("Please check aggree to all fields are correct");return}s.fire({title:"If all fields are correct and please click to continue to save",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Continue",icon:"warning",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(r=>{if(r.isConfirmed){s.fire({title:`Saving Records.
Please wait.`,html:'<i class="fa fa-times-circle-o"></i>&nbsp;&nbsp;Close',showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,didOpen:()=>{s.showLoading()}});let b={teacher_id:o,teacher_name:a,year_level:n,school_sections_id:u,section_name:c,schoolyear:h,subject_id:f};v.post("/advisory",b).then(async function(i){console.log(i),typeof i.status<"u"&&i.status=="201"?(typeof i.data<"u"&&typeof i.data<"u"?i.data:{}).status=="success"?s.fire({title:"Successfuly save!",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Continue",icon:"success",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(function(j){j.isConfirmed&&(s.close(),$("#newAdvisory").modal("hide"),t.getAllData())}):s.fire({title:"Fail to save",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0}):typeof i.status<"u"&&i.status=="200"?(typeof i.data<"u"&&typeof i.data<"u"?i.data:{}).status=="data_exist"&&s.fire({title:"Data Exist",cancelButtonText:"Ok",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}):typeof i.status<"u"&&i.status=="422"}).catch(function(i){console.log(i),s.fire({title:"Server Error",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})})}else r.isDismissed;return!1})}else o==""&&($("#fteacher-alert").removeAttr("class"),$("#teacher-alert").html("Required Field"),$("#teacher-alert").addClass("d-block invalid-feedback")),l==""&&($("#yearlevel-alert").removeAttr("class"),$("#yearlevel-alert").html("Required Field"),$("#yearlevel-alert").addClass("d-block invalid-feedback")),u==""&&($("#section-alert").removeAttr("class"),$("#section-alert").html("Required Field"),$("#section-alert").addClass("d-block invalid-feedback")),h==""&&($("#schoolyear-alert").removeAttr("class"),$("#schoolyear-alert").html("Required Field"),$("#schoolyear-alert").addClass("d-block invalid-feedback")),f==""&&($("#subject-alert").removeAttr("class"),$("#subject-alert").html("Required Field"),$("#subject-alert").addClass("d-block invalid-feedback"))}render(){return e.jsxs(g,{title:"Subject",user:this.props.auth.user,profile:this.props.auth.profile,children:[e.jsx("div",{className:"app-content-header",children:e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-6",children:e.jsxs("h3",{className:"mb-0",children:[e.jsx("i",{className:"nav-icon bi bi-card-list"})," Teacher's Advisory"]})}),e.jsx("div",{className:"col-sm-6",children:e.jsxs("ol",{className:"breadcrumb float-sm-end",children:[e.jsxs("li",{className:"breadcrumb-item",children:[" ",e.jsx("i",{className:"bi bi-speedometer mr-2"}),e.jsx(m,{href:"/admin/dashboard",children:"Dashboard"})]}),e.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:"Advisory"})]})})]})})}),e.jsx("div",{className:"app-content",children:e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title  mt-2",children:[" ",e.jsx("i",{className:"bi bi-person"})," List"]})}),e.jsx("div",{className:"card-body",children:e.jsx(p,{className:"table table-bordered table-striped ",data:this.state.data,columns:this.state.columns},"react-tables")})]})})})})}),e.jsx("datalist",{id:"selectedTeacher",children:e.jsx(d,{of:this.state.teachers,render:(t,a)=>e.jsx("option",{children:`${t.last_name}, ${t.first_name}`})})}),e.jsx("datalist",{id:"selectedYearLevel",children:e.jsx(d,{of:this.state.yeargrade,render:(t,a)=>e.jsx("option",{children:`${t.year_grade}`})})}),e.jsx("datalist",{id:"selectedSection",children:e.jsx(d,{of:this.state.sectionList,render:(t,a)=>e.jsx("option",{children:`${t.section_name}`})})}),e.jsx("datalist",{id:"selectedSY",children:e.jsx("option",{children:"2025 - 2026"})}),e.jsx("datalist",{id:"selectedSubject",children:e.jsx(d,{of:this.state.teachers,render:(t,a)=>e.jsx("option",{children:`${t.last_name}, ${t.first_name}`})})}),e.jsx("div",{className:"modal fade",tabIndex:"-1",role:"dialog",id:"newAdvisory","aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title fs-5",children:"New Advisory"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{htmlFor:"teacher",className:"form-label",children:"Teacher"}),e.jsx("input",{type:"text",className:"form-control",list:"selectedTeacher",id:"teacher",defaultValue:"",required:"",onChange:t=>{$("#teacher-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({selectedTeacher:t.target.value})}}),e.jsx("div",{id:"teacher-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{htmlFor:"yearlevel",className:"form-label",children:"Year Level"}),e.jsx("select",{name:"yearlevel",id:"yearlevel",className:"form-control",onChange:t=>{$("#teacher-alert").removeAttr("class").addClass("invalid-feedback"),$("#section").val(""),console.log(t.target.value),t.target.value!=""&&this.setState({selectedYearLevel:t.target.value,sectionList:this.state.sectionListTemp.filter(a=>a.year_grade_id==t.target.value)})},children:e.jsx(d,{of:this.state.yeargrade,render:(t,a)=>e.jsx("option",{value:`${t.id}`,children:`${t.year_grade}`})})}),e.jsx("div",{id:"yearlevel-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{htmlFor:"section",className:"form-label",children:"Section"}),e.jsx("input",{type:"text",className:"form-control",list:"selectedSection",id:"section",defaultValue:"",required:"",onChange:t=>{$("#teacher-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({selectedSection:t.target.value})}}),e.jsx("div",{id:"section-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{htmlFor:"schoolyear",className:"form-label",children:"School Year"}),e.jsx("input",{type:"text",className:"form-control",list:"selectedSY",id:"schoolyear",defaultValue:"",required:"",onChange:t=>{$("#teacher-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({selectedSY:t.target.value})}}),e.jsx("div",{id:"schoolyear-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{htmlFor:"subject",className:"form-label",children:"Subject"}),e.jsxs("select",{className:"form-select",id:"subject",required:"",onChange:t=>{$("#extension-name-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({selectedSubject:t.target.value})},children:[e.jsx("option",{disabled:!0,children:"Choose..."}),e.jsx("option",{}),e.jsx(d,{of:this.state.subjects,render:(t,a)=>e.jsx("option",{value:t.id,children:t.subject_name})})]}),e.jsx("div",{id:"extension-name-alert",className:"invalid-feedback",children:"Please select a valid state."})]})]})})}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{className:"btn btn-success float-right mr-1",onClick:()=>{this.saveData()},children:[" ",e.jsx("i",{className:"bi bi-save"})," Save"]}),e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})]})]})})})]})}}export{q as default};
