var f=Object.defineProperty;var p=(n,d,a)=>d in n?f(n,d,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[d]=a;var c=(n,d,a)=>p(n,typeof d!="symbol"?d+"":d,a);import{r as x,R as b,a as u,j as e,U as m}from"./app-MQ-yEurC.js";import{E as v}from"./EachMethod-DlQbtg5B.js";import{S as i}from"./sweetalert2.esm.all-DPJM2oV6.js";import{h as j}from"./moment-C5S46NFB.js";import"./index-FTPeQx5Q.js";import{D as g}from"./DashboardLayout-Q83-rxtQ.js";import{Q as N}from"./index-B9Tcu3qw.js";import{W as C}from"./react-webcam-C_JsNYoc.js";import{I as k}from"./ImageCrop-BhIjMigO.js";import"./Dropdown-DtFVle0_.js";import"./transition-CQN9Mefa.js";import"./index-DzSybp8L.js";class R extends x.Component{constructor(a){super(a);c(this,"getBase64",(a,l)=>{let t=new FileReader;t.readAsDataURL(a),t.onload=function(){l(t.result)},t.onerror=function(s){console.log("Error: ",s)}});c(this,"onFileChange",a=>{if($(".progress-bar").css("width","0%"),a.target.files.length){const{name:l,type:t}=a.target.files[0];let s="pdf";t=="application/pdf"?s="pdf":t=="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||t=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?s="docs":(t=="image/png"||t=="image/jpeg")&&(s="image"),this.getBase64(a.target.files[0],r=>{this.setState({photoupload:r,filedata:r,filedataName:l,filetype:t,filetype_:s})}),$("#fileuploadpanel").modal("show")}});this.state={photoupload:"",photobase64:"",photobase64final:"",lrn:"",psa_cert_no:"",qrcode:"",first_name:"",last_name:"",middle_name:"",extension_name:"",sex:"",bdate:"",status:"",email:"",address:"",contact_list:[],filedata:null,filedataName:"",filetype:"",filetype_:"",cameraOn:!1,bdate_max:j(new Date).subtract("years",15).format("YYYY-MM-DD")},this.webCam=b.createRef(),this.updateCrop=this.updateCrop.bind(this),this._isMounted=!1}componentDidMount(){this._isMounted=!0,console.log(this)}updateCrop(a){this.setState({photobase64final:a})}saveData(){let a=this;if(a.state.first_name!=""&&a.state.middle_name!=""&&a.state.last_name!=""&&a.state.sex!=""&&a.state.bdate!=""&&a.state.lrn!=""){if($("#invalidCheck").prop("checked")==!1){$("#invalidCheck-alert").removeAttr("class"),$("#invalidCheck-alert").addClass("d-block invalid-feedback"),alert("Please check aggree to all fields are correct");return}i.fire({title:"If all fields are correct and please click to continue to save",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"warning",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(l=>{if(l.isConfirmed){i.fire({title:`Submitting Records.
Please wait.`,html:'<i class="fa fa-times-circle-o"></i>&nbsp;&nbsp;Close',showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,didOpen:()=>{i.showLoading()}});let t={qr_code:a.state.lrn,first_name:a.state.first_name,last_name:a.state.last_name,middle_name:a.state.middle_name,extension_name:a.state.extension_name,bdate:a.state.bdate,status:"active",picture_base64:a.state.photobase64final,email:a.state.email,sex:a.state.sex,current_address:a.state.address,contact_list:a.state.contact_list};console.log(t),u.post("/parents",t).then(async function(s){if(console.log(s),typeof s.status<"u"&&s.status=="201"){let r=typeof s.data<"u"&&typeof s.data<"u"?s.data:{};(r.status="sucess")?(a.state.contact_list.forEach(async o=>{console.log({type:null,student_id:null,teacher_id:s.data.data.id,guardian_id:null,phone_number:o.phone_number,telephone_number:o.phone_number}),u.post("/contacts",{type:null,student_id:null,teacher_id:s.data.data.id,guardian_id:null,phone_number:o.phone_number,telephone_number:o.phone_number}).then(function(h){typeof h.status<"u"&&h.status=="201"})}),i.fire({title:"Successfuly save!",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"success",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(function(o){o.isConfirmed&&(i.close(),document.getElementById("cancel").click())})):i.fire({title:"Fail to save",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0})}else if(typeof s.status<"u"&&s.status=="200"){let r=typeof s.data<"u"&&typeof s.data<"u"?s.data:{};(r.status="data_exist")&&i.fire({title:"Data Exist",cancelButtonText:"Ok",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})}else typeof s.status<"u"&&s.status=="422"}).catch(function(s){console.log(s),i.fire({title:"Server Error",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})})}else l.isDismissed;return!1})}else a.state.first_name==""&&($("#first-name-alert").removeAttr("class"),$("#first-name-alert").html("Required Field"),$("#first-name-alert").addClass("d-block invalid-feedback")),a.state.middle_name==""&&($("#middle-name-alert").removeAttr("class"),$("#middle-name-alert").html("Required Field"),$("#middle-name-alert").addClass("d-block invalid-feedback")),a.state.last_name==""&&($("#last-name-alert").removeAttr("class"),$("#last-name-alert").html("Required Field"),$("#last-name-alert").addClass("d-block invalid-feedback")),a.state.sex==""&&($("#sex-alert").removeAttr("class"),$("#sex-alert").html("Required Field"),$("#sex-alert").addClass("d-block invalid-feedback")),a.state.bdate==""&&($("#bdate-alert").removeAttr("class"),$("#bdate-alert").html("Required Field"),$("#bdate-alert").addClass("d-block invalid-feedback")),a.state.lrn==""&&($("#lrn-alert").removeAttr("class"),$("#lrn-alert").html("Required Field"),$("#lrn-alert").addClass("d-block invalid-feedback"))}render(){return e.jsx(g,{title:"New Teacher",user:this.props.auth.user,children:e.jsxs("div",{className:"noselect",children:[e.jsx("div",{className:"app-content-header",children:e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-6",children:e.jsxs("h3",{className:"mb-0",children:[e.jsx("i",{className:"nav-icon bi bi-person-lines-fill"})," Parents / Guardian"]})}),e.jsx("div",{className:"col-sm-6",children:e.jsxs("ol",{className:"breadcrumb float-sm-end",children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx(m,{href:"/admin/dashboard",children:"Dashboard"})}),e.jsx("li",{className:"breadcrumb-item",children:e.jsx(m,{href:"/admin/dashboard/parents",children:"Parents / Guardian"})}),e.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:"New Account"})]})})]})})}),e.jsx("div",{className:"app-content",children:e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"card mb-4",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title mt-2",children:[" ",e.jsx("i",{className:"bi bi-person"})," New Account"]}),e.jsxs(m,{href:"/admin/dashboard/parents",id:"cancel",className:"btn btn-danger float-right",children:[" ",e.jsx("i",{className:"bi bi-person-fill-x"})," Cancel"]}),e.jsxs("button",{className:"btn btn-success float-right mr-1",onClick:()=>{this.saveData()},children:[" ",e.jsx("i",{className:"bi bi-person-plus-fill"})," Save"]})]}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx("img",{className:"photo-upload border_shadow",src:this.state.photobase64final!=""?this.state.photobase64final:"/adminlte/dist/assets/img/avatar.png",ref:a=>this.upload_view_image=a,onError:a=>{this.upload_view_image.src="/adminlte/dist/assets/img/avatar.png"},alt:"Picture Error"})}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"file",className:"form-control",id:"inputGroupFile02",onChange:this.onFileChange}),e.jsx("span",{className:"input-group-text",htmlFor:"inputGroupFile02",onClick:()=>{this.setState({cameraOn:!0}),$("#camerapanel").modal("show")},children:e.jsx("i",{className:"bi bi-camera"})})]})]}),e.jsxs("div",{className:"col-md-8 d-flex flex-column justify-content-end",children:[e.jsx(N,{value:this.state.lrn,size:256,style:{height:"170px",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"}),e.jsx("label",{htmlFor:"lrn",className:"form-label ",children:"Identification Number"}),e.jsx("input",{type:"text",className:"form-control",id:"lrn",defaultValue:String(this.props.id).padStart(10,"0"),required:"",onChange:a=>{$("#lrn-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({lrn:a.target.value})}}),e.jsx("span",{id:"lrn-alert",className:"valid-feedback",children:"Looks good!"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"first_name",className:"form-label",children:"First name"}),e.jsx("input",{type:"text",className:"form-control",id:"first_name",defaultValue:"",required:"",onChange:a=>{$("#first-name-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({first_name:a.target.value})}}),e.jsx("div",{id:"first-name-alert",className:"valid-feedback",children:"Looks good!"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"middle_name",className:"form-label",children:"Middle name"}),e.jsx("input",{type:"text",className:"form-control",id:"middle_name",defaultValue:"",required:"",onChange:a=>{$("#middle-name-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({middle_name:a.target.value})}}),e.jsx("div",{id:"middle-name-alert",className:"valid-feedback",children:"Looks good!"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"last_name",className:"form-label",children:"Last name"}),e.jsx("input",{type:"text",className:"form-control",id:"last_name",defaultValue:"",required:"",onChange:a=>{$("#last-name-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({last_name:a.target.value})}}),e.jsx("div",{id:"last-name-alert",className:"valid-feedback",children:"Looks good!"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"extension_name",className:"form-label",children:"Extension name"}),e.jsxs("select",{className:"form-select",id:"extension_name",required:"",defaultValue:"",onChange:a=>{$("#extension-name-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({extension_name:a.target.value})},children:[e.jsx("option",{disabled:!0,children:"Choose..."}),e.jsx("option",{}),e.jsx("option",{children:"Jr."}),e.jsx("option",{children:"Sr."}),e.jsx("option",{children:"II"}),e.jsx("option",{children:"III"}),e.jsx("option",{children:"VI"}),e.jsx("option",{children:"V"})]}),e.jsx("div",{id:"extension-name-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"gender",className:"form-label",children:"Gender"}),e.jsxs("select",{className:"form-select",id:"gender",required:"",defaultValue:"",onChange:a=>{$("#sex-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({sex:a.target.value})},children:[e.jsx("option",{disabled:!0,children:"Choose..."}),e.jsx("option",{}),e.jsx("option",{children:"Male"}),e.jsx("option",{children:"Female"})]}),e.jsx("div",{id:"sex-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"bdate",className:"form-label",children:"Birth Date"}),e.jsx("input",{type:"date",className:"form-control",id:"bdate",defaultValue:"",required:"",max:this.state.bdate_max,onChange:a=>{$("#bdate-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({bdate:a.target.value})}}),e.jsx("div",{id:"bdate-alert",className:"valid-feedback",children:"Looks good!"})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{htmlFor:"bdate",className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",id:"email",defaultValue:"",required:"",onChange:a=>{$("#email-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({email:a.target.value})}}),e.jsx("div",{id:"email-alert",className:"valid-feedback",children:"Looks good!"})]}),e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{htmlFor:"bdate",className:"form-label",children:"Current Address"}),e.jsx("input",{type:"text",className:"form-control",id:"address",defaultValue:"",required:"",onChange:a=>{$("#address-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({address:a.target.value})}}),e.jsx("div",{id:"address-alert",className:"valid-feedback",children:"Looks good!"})]})]}),e.jsxs("div",{className:"col-lg-12",children:[e.jsx("hr",{}),e.jsx("h5",{className:"badge fs-5 bg-primary text-start d-block",children:"Contacts"}),e.jsx("div",{className:"row",children:e.jsx(v,{of:this.state.contact_list,render:(a,l)=>e.jsxs("div",{className:"input-group ",children:[e.jsx("div",{className:"input-group-prepend col-lg-4",children:e.jsx("div",{htmlFor:"lglv",className:"input-group-text",children:a.phone_number})}),e.jsx("button",{className:"btn btn-danger",onClick:()=>{},children:"Remove"})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:`${this.state.contact_list.length>0?"form-inline col-lg-6 pt-2":"form-inline col-lg-6"}`,children:e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("div",{htmlFor:"lglv",className:"input-group-text",children:"Phone Number : "})}),e.jsx("input",{type:"number",className:"form-control col-2",id:"phonenumber",maxLength:12,defaultValue:"",placeholder:"09000000000",required:""}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{let a=this.state.contact_list,l=$("#phonenumber").val();l!=""&&a.some(t=>t.phone_number==l)==!1?(a.push({id:null,type:null,student_id:null,teacher_id:null,guardian_id:null,phone_number:$("#phonenumber").val(),telephone_number:null,status:""}),this.setState({contact_list:a})):l!=""&&i.fire({title:"Sorry already added",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})},children:"Add"})]})})})]}),e.jsx("div",{className:"col-12 pt-3",children:e.jsxs("div",{className:"form-check float-right",children:[e.jsx("br",{}),e.jsx("input",{className:"form-check-input",type:"checkbox",defaultValue:"",id:"invalidCheck",required:""}),e.jsx("label",{className:"form-check-label",htmlFor:"invalidCheck",children:"Agree to all fields are correct"}),e.jsx("div",{id:"invalidCheck-alert",className:"invalid-feedback",children:"You must agree before submitting."})]})})]})]})})})})}),e.jsx("div",{className:"modal fade",tabIndex:"-1",role:"dialog",id:"fileuploadpanel","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title fs-5",children:"Image"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsx(k,{src:this.state.photoupload,onChange:this.updateCrop})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})}),e.jsx("div",{className:"modal fade",tabIndex:"-1",role:"dialog",id:"camerapanel","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title fs-5",children:"Camera Capture"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal",onClick:()=>{this.setState({cameraOn:!1})},"aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:this.state.cameraOn==!0?e.jsx(C,{className:"webcam",audio:!1,screenshotFormat:"image/jpeg",videoConstraints:{width:600,height:600,facingMode:"user"},mirrored:!0,screenshotQuality:1,imageSmoothing:!0,ref:this.webCam}):null}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{this.setState({cameraOn:!1})},"data-bs-dismiss":"modal",children:"Close"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{try{this.setState({photoupload:this.webCam.current.getScreenshot({width:400,height:400}),cameraOn:!1},()=>{$("#camerapanel").modal("hide"),$("#fileuploadpanel").modal("show")})}catch{alert("Pleasse try again")}},children:"Capture"})]})]})})})]})})}}export{R as default};
