import{r as m,j as e,a as c,U as f}from"./app-MQ-yEurC.js";import{E as n}from"./EachMethod-DlQbtg5B.js";import{S as l}from"./sweetalert2.esm.all-DPJM2oV6.js";import"./moment-C5S46NFB.js";import"./react-webcam-C_JsNYoc.js";import"./apexcharts.esm-CWma0ncG.js";import{Q as x}from"./browser-Bt5TlLty.js";import{R as p}from"./ReactTable-CiiRreiS.js";import{D as v}from"./DashboardLayout-Q83-rxtQ.js";import"./index-FTPeQx5Q.js";import"./Dropdown-DtFVle0_.js";import"./transition-CQN9Mefa.js";import"./index-DzSybp8L.js";class q extends m.Component{constructor(t){super(t),this.state={data:this.props.students,columns:[{id:"no",accessor:"no",Header:"No.",width:100,className:"center"},{id:"picture",Header:"Picture",accessor:"photo",Cell:({row:s})=>e.jsx("img",{className:"",height:150,width:150,onError:a=>{a.target.src=s.original.sex=="Male"?"/adminlte/dist/assets/img/avatar.png":"/adminlte/dist/assets/img/avatar-f.jpeg"},alt:"Picture Error",src:s.original.photo!=null&&s.original.photo!=""?s.original.photo:s.original.sex=="Male"?"/adminlte/dist/assets/img/avatar.png":"/adminlte/dist/assets/img/avatar-f.jpeg"})},{id:"lrn",accessor:"lrn",Header:"LRN NO.",maxWidth:100},{id:"fullname",Header:"Fullname",width:800,accessor:"fullname"},{id:"action",Header:"Action",width:200,accessor:"fullname",className:"center",Cell:({row:s})=>e.jsx(e.Fragment,{children:e.jsxs("button",{className:"btn btn-danger btn-block btn-sm col-12 mb-1",onClick:()=>{this.deleteStudent(s.original.id)},children:[" ",e.jsx("i",{className:"bi bi-person-fill-x"})," Remove"]})})}],studentsList:this.props.studentsList,yeargrade:this.props.schoolyeargrades,class:this.props.class,advisoryList:this.props.advisory,sectionListTemp:this.props.sections,track:this.props.track,strand:this.props.strand,advisory:typeof this.props.advisory<"u"&&this.props.advisory.length>0?this.props.advisory[0]:{},qr_code:"",qr_code_data:"",room_name:"",room_number:""},this._isMounted=!1,this.loadStudentList=this.loadStudentList.bind(this),this.deleteStudent=this.deleteStudent.bind(this),this.getAllData=this.getAllData.bind(this),this.saveStudent=this.saveStudent.bind(this),console.log(this.props)}componentDidMount(){this._isMounted=!0,this.getAllData()}getAllData(){let t=this;c.get("/teacher/advisory/student/"+this.props.code).then(function(s){if(typeof s.status<"u"&&s.status=="200"){let a=typeof s.data<"u"&&typeof s.data<"u"?s.data:{};Object.keys(a).length>0&&t.setState({data:a.students,studentList:a.studentList,class:a.class,advisoryList:a.advisory,sectionListTemp:a.sections,sectionList:a.schoolyeargrades,yeargrade:a.schoolyeargrades,track:a.track,strand:a.strand,studentsList:a.studentsList,advisory:typeof a.advisory<"u"&&a.advisory.length>0?a.advisory[0]:{}})}})}loadStudentList(){let t=[],s=this;c.get("/student").then(function(a){typeof a.status<"u"&&a.status=="200"&&(typeof a.data<"u"&&typeof a.data.data<"u"?a.data.data:[]).forEach((i,r,o)=>{i.status!="remove"&&t.push({no:r+1,id:i.id,photo:i.picture_base64,lrn:i.lrn,fullname:`${i.last_name}, ${i.first_name} ${i.extension_name!=null?i.extension_name:""} ${i.middle_name}`.toLocaleUpperCase(),level:"None",section:"None",sex:i.sex,status:i.status}),r+1==o.length&&s.setState({data:t})})}).catch(function(a){}).finally(function(){})}deleteStudent(t){let s=this;l.fire({title:"Are you sure to remove this data?",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Yes",confirmButtonColor:"red",icon:"question",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(a=>{a.isConfirmed?(l.fire({title:`Removing Records.
Please wait.`,showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,didOpen:()=>{l.showLoading()}}),c.delete("/teacher/advisory/student",{data:{id:t}}).then(function(d){typeof d.status<"u"&&d.status=="201"?(typeof d.data<"u"&&typeof d.data<"u"?d.data:{}).status=="success"?l.fire({title:"Successfuly remove!",showCancelButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Ok",icon:"success",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(function(r){r.isConfirmed&&(l.close(),s.getAllData())}):l.fire({title:"Fail to remove",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0}):typeof d.status<"u"&&d.status=="200"&&(typeof d.data<"u"&&typeof d.data<"u"?d.data:{}).status=="data_not_exist"&&l.fire({title:"Data Not Exist",cancelButtonText:"Ok",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})}).catch(function(d){console.log(d),l.fire({title:"Server Error",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})})):l.close()})}saveStudent(){let t=this,s=$("#studentselection").val(),a=t.state.studentsList.find(i=>`${i.last_name}, ${i.first_name}`==s).id,d=t.state.advisory.id;s!=""&&typeof a<"u"&&typeof d<"u"?l.fire({title:"You select "+s.toLocaleUpperCase()+" and please click to continue to save",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Continue",icon:"warning",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(i=>{if(i.isConfirmed){l.fire({title:`Saving Records.
Please wait.`,html:'<i class="fa fa-times-circle-o"></i>&nbsp;&nbsp;Close',showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,didOpen:()=>{l.showLoading()}});let r={advisory_id:d,select_student_id:a};c.post("/teacher/advisory/student/add",r).then(async function(o){typeof o.status<"u"&&o.status=="201"?(typeof o.data<"u"&&typeof o.data<"u"?o.data:{}).status=="success"?l.fire({title:"Successfuly save!",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Continue",icon:"success",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}).then(function(h){h.isConfirmed&&(l.close(),$("#studentModel").modal("hide"),t.getAllData())}):l.fire({title:"Fail to save",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!1,closeOnClickOutside:!1,dangerMode:!0}):typeof o.status<"u"&&o.status=="200"?(typeof o.data<"u"&&typeof o.data<"u"?o.data:{}).status=="data_exist"&&l.fire({title:s.toLocaleUpperCase()+" is ready added",cancelButtonText:"Ok",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0}):typeof o.status<"u"&&o.status=="422"}).catch(function(o){console.log(o),l.fire({title:"Server Error",showCancelButton:!0,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonText:"Ok",confirmButtonText:"Continue",confirmButtonColor:"#DD6B55",icon:"error",showLoaderOnConfirm:!0,closeOnClickOutside:!1,dangerMode:!0})})}else i.isDismissed;return!1}):s==""&&($("#studentselection-alert").removeAttr("class"),$("#studentselection-alert").html("Required Field"),$("#studentselection-alert").addClass("d-block invalid-feedback"))}async generateQR(t){let s=this;try{let a=await x.toDataURL(t,{errorCorrectionLevel:"H",width:500});s.setState({qr_code:t,qr_code_data:a})}catch(a){console.error(a)}}render(){return e.jsxs(v,{title:"Student",user:this.props.auth.user,profile:this.props.auth.profile,children:[e.jsx("div",{className:"app-content-header",children:e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-6",children:e.jsxs("h3",{className:"mb-0",children:[e.jsx("i",{className:"nav-icon bi bi-person-lines-fill"})," Student"]})}),e.jsx("div",{className:"col-sm-6",children:e.jsxs("ol",{className:"breadcrumb float-sm-end",children:[e.jsxs("li",{className:"breadcrumb-item",children:[e.jsx("i",{className:"bi bi-speedometer mr-2"}),e.jsx(f,{href:"/admin/dashboard",children:"Dashboard"})]}),e.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:"Student"})]})})]})})}),e.jsx("div",{className:"app-content",children:e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"yearlevel",className:"form-label",children:"Grade"}),e.jsxs("select",{name:"yearlevel",id:"yearlevel",className:"form-control",value:this.state.yeargrade.find(t=>t.year_grade==this.state.advisory.year_level).id,"aria-readonly":!0,onChange:t=>{},children:[e.jsx("option",{disabled:!0,children:"--Select Grade--"}),e.jsx("option",{value:""}),e.jsx(n,{of:this.state.yeargrade,render:(t,s)=>e.jsx("option",{value:`${t.id}`,children:`${t.year_grade}`})})]}),e.jsx("div",{id:"yearlevel-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"sectionname",className:"form-label",children:"Section Name"}),e.jsx("input",{type:"text",className:"form-control",id:"sectionname",defaultValue:this.state.advisory.section_name,required:"",onChange:t=>{$("#sectionname-alert").removeAttr("class").addClass("invalid-feedback")}}),e.jsx("div",{id:"sectionname-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"schoolyear",className:"form-label",children:"School Year"}),e.jsx("input",{type:"text",className:"form-control",list:"selectedSY",id:"schoolyear",defaultValue:this.state.advisory.school_year,required:"",onChange:t=>{$("#schoolyear-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({selectedSY:t.target.value})}}),e.jsx("div",{id:"schoolyear-alert",className:"invalid-feedback",children:"Please select a valid state."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"flsh_track",className:"form-label",children:"Track"}),e.jsxs("select",{name:"flsh_track",id:"flsh_track",className:"form-control",defaultValue:this.state.advisory.track,onChange:t=>{$("#flsh_track-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({flsh_track:t.target.value})},children:[e.jsx("option",{value:""}),e.jsx(n,{of:this.state.track,render:(t,s)=>e.jsx("option",{children:`${t.name} ${t.acronyms!=""?"("+t.acronyms+")":""}`})})]}),e.jsx("div",{id:"flsh_track-alert",className:"valid-feedback",children:"Looks good!"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"flsh_strand",className:"form-label",children:"Strand"}),e.jsxs("select",{name:"flsh_strand",id:"flsh_strand",className:"form-control",defaultValue:this.state.advisory.strands,onChange:t=>{$("#flsh_strand-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({flsh_strand:t.target.value})},children:[e.jsx("option",{value:""}),e.jsx(n,{of:this.state.strand,render:(t,s)=>e.jsx("option",{children:`${t.name} ${t.acronyms!=""?"("+t.acronyms+")":""}`})})]}),e.jsx("div",{id:"flsh_strand-alert",className:"valid-feedback",children:"Looks good!"})]}),e.jsx("div",{className:"col-md-6 pt-4",children:e.jsxs("button",{className:"btn btn-info",onClick:async()=>{typeof this.state.advisory.qrcode<"u"&&this.state.advisory.qrcode!=null&&(await this.generateQR(this.state.advisory.qrcode),this.setState({room_name:this.state.advisory.section_name,room_number:this.state.advisory.room_number}),$("#qrcode").modal("show"))},children:[" ",e.jsx("i",{className:"bi bi-qr-code"})," QR"]})})]}),e.jsx("br",{}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"row d-flex",children:[e.jsx("div",{className:"col-lg-2 me-auto",children:e.jsxs("h3",{className:"card-title mt-2 ",children:[" ",e.jsx("i",{className:"bi bi-person"})," Student List"]})}),e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:"School Year"}),e.jsxs("select",{className:"form-select",id:"gender",required:"",defaultValue:"",children:[e.jsx("option",{disabled:!0,children:"Choose..."}),e.jsx("option",{children:"All"}),e.jsx("option",{children:"2021-2022"}),e.jsx("option",{children:"2022-2023"}),e.jsx("option",{children:"2023-2024"}),e.jsx("option",{children:"2024-2025"}),e.jsx("option",{children:"2025-2026"})]})]})}),e.jsxs("button",{className:"btn btn-primary col-lg-1 mr-1",onClick:()=>{$("#studentModel").modal("show")},children:[" ",e.jsx("i",{className:"bi bi-person-plus-fill"})," Add"]})]})}),e.jsx("div",{className:"card-body",children:e.jsx(p,{className:"table table-bordered table-striped ",data:this.state.data,columns:this.state.columns,showHeader:!0,showPagenation:!0,defaultPageSize:5},"react-tables")})]})})})]})}),e.jsx("datalist",{id:"selectedTeacher",children:e.jsx(n,{of:this.state.teachers,render:(t,s)=>e.jsx("option",{children:`${t.last_name}, ${t.first_name}`})})}),e.jsx("datalist",{id:"selectedYearLevel",children:e.jsx(n,{of:this.state.yeargrade,render:(t,s)=>e.jsx("option",{children:`${t.year_grade}`})})}),e.jsx("datalist",{id:"selectedSection",children:e.jsx(n,{of:this.state.sectionList,render:(t,s)=>e.jsx("option",{children:`${t.section_name}`})})}),e.jsx("datalist",{id:"selectedSY",children:e.jsx("option",{children:"2025 - 2026"})}),e.jsx("datalist",{id:"selectedSubject",children:e.jsx(n,{of:this.state.teachers,render:(t,s)=>e.jsx("option",{children:`${t.last_name}, ${t.first_name}`})})}),e.jsx("datalist",{id:"selectStudent",children:e.jsx(n,{of:this.state.studentsList,render:(t,s)=>e.jsx("option",{children:`${t.last_name}, ${t.first_name}`})})}),e.jsx("div",{className:"modal fade",tabIndex:"-1",role:"dialog",id:"studentModel","aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title fs-5",children:"Add Student"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{htmlFor:"studentselection",className:"form-label",children:"Student"}),e.jsx("input",{type:"text",className:"form-control",list:"selectStudent",id:"studentselection",defaultValue:"",required:"",onChange:t=>{$("#studentselection-alert").removeAttr("class").addClass("invalid-feedback"),this.setState({studentselection:t.target.value})}}),e.jsx("div",{id:"studentselection-alert",className:"invalid-feedback",children:"Please select a valid state."})]})})})}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{className:"btn btn-success float-right mr-1",onClick:()=>{this.saveStudent()},children:[" ",e.jsx("i",{className:"bi bi-save"})," Add"]}),e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})]})]})})}),e.jsx("div",{className:"modal fade",tabIndex:"-1",role:"dialog",id:"qrcode","aria-hidden":"false","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title fs-5",children:"QR"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"row g-3",children:e.jsx("div",{className:"my-qr-code ",children:e.jsxs("div",{className:"my-qr-code-content",children:[e.jsxs("div",{className:"center",children:[e.jsx("strong",{children:this.state.room_name.toLocaleUpperCase()}),e.jsx("br",{}),e.jsxs("strong",{children:["Room No.:",this.state.room_number.toLocaleUpperCase()]})]}),e.jsx("img",{src:this.state.qr_code_data,className:"mx-auto"})]})})})})}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>{let t=window.open();t.document.write($(".my-qr-code").html()),t.print(),t.close()},children:[e.jsx("i",{className:"bi bi-printer"})," Print"]}),e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})]})]})})})]})}}export{q as default};
